import{a as D}from"./chunk-TA72PURZ.js";import{a as F}from"./chunk-4MHKQR7U.js";import{a as N}from"./chunk-MMUSKXOL.js";import"./chunk-3BA7FMGK.js";import"./chunk-YVT3WIWJ.js";import"./chunk-OUIXM5MW.js";import"./chunk-P74D5YH2.js";import{c as P,f as E,j as L}from"./chunk-AGUO72EF.js";import{$a as y,Ia as m,La as d,Lb as T,Oa as u,Pa as _,Qa as v,Ra as C,Sa as r,Ta as a,Ua as g,Xa as c,Y as x,eb as p,fb as b,gb as h,hb as S,mb as I,nb as f,ob as j,pb as w,ya as o,za as l}from"./chunk-NTXE5QSV.js";import"./chunk-GAL4ENT6.js";var A=t=>({categoryId:t}),O=t=>({categoryName:t});function $(t,n){t&1&&(r(0,"div",1),g(1,"app-loading"),a())}function H(t,n){if(t&1&&(r(0,"span",7),p(1),j(2,"date"),a()),t&2){let e=c().$implicit,i=c(2);o(),S(" Dernier message : ",w(2,2,i.lastPost[e.s_id].p_date,"dd/MM/yyyy, HH:mm")," par ",i.lastPost[e.s_id].author_username," ")}}function U(t,n){if(t&1&&(r(0,"div",5)(1,"a",6),p(2),a(),m(3,H,3,5,"span",7),a()),t&2){let e=n.$implicit,i=c(2);o(),y("routerLink","/forum/subject/",e.s_id,""),d("state",f(5,O,i.categorieName)),o(),h(" ",e.s_title," "),o(),u(i.lastPost[e.s_id]?3:-1)}}function q(t,n){if(t&1&&(r(0,"div",2)(1,"h1",3),p(2),a(),r(3,"button",4),p(4,"Nouveau sujet"),a()(),v(5,U,4,7,"div",5,_)),t&2){let e=c();o(2),b(e.categorieName),o(),d("state",f(2,A,e.id_categorie)),o(2),C(e.subjectInThisCategory)}}var R=class t{constructor(n,e){this.activatedRoute=n;this.forumService=e}id_categorie;currentCategory;subjectInThisCategory;lastPost;categorieName;isCatLoading=!0;isSubPostLoading=!0;ngOnInit(){this.activatedRoute.params.subscribe(n=>{this.id_categorie=+n.id,this.forumService.getSubjectsByCategoryId(this.id_categorie).subscribe({next:e=>{this.subjectInThisCategory=e,this.lastPost={},this.categorieName=this.subjectInThisCategory[0].c_title,this.subjectInThisCategory.forEach(i=>{this.forumService.getPostsBySubjectId(i.s_id).subscribe({next:s=>{if(s&&s.length>0){let k=s.sort((M,B)=>new Date(B.p_date).getTime()-new Date(M.p_date).getTime())[0];this.lastPost[i.s_id]=k}this.isSubPostLoading=!1},error:s=>console.error(`Erreur lors de la r\xE9cup\xE9ration des posts pour le sujet ${i.s_id}`,s)})})},error:e=>console.error("Erreur lors de la r\xE9cup\xE9ration des sujets de cette cat\xE9gorie",e)})})}static \u0275fac=function(e){return new(e||t)(l(P),l(D))};static \u0275cmp=x({type:t,selectors:[["app-single-categorie"]],standalone:!0,features:[I],decls:4,vars:1,consts:[[1,"relative","top-[160px]","md:top-[125px]","mx-20","pb-[45px]"],[1,"text-orange","w-full","flex","justify-center"],[1,"w-full","bg-blue","text-white-base","rounded","px-4","py-2","mb-[24px]","flex","flex-wrap","justify-between"],[1,"text-2xl","font-revalia","self-center"],["routerLink","/forum/new",1,"btn","btn-white",3,"state"],[1,"w-9/10","flex","flex-wrap","justify-between","bg-orange","text-white-base","hover:bg-white-base","hover:text-orange","rounded-sm","mx-auto","my-1","px-2","py-1","last:mb-[40px]","font-revalia"],[3,"routerLink","state"],[1,"font-helvetica"]],template:function(e,i){e&1&&(g(0,"app-user-snippet"),r(1,"div",0),m(2,$,2,0,"div",1)(3,q,7,4),a()),e&2&&(o(2),u(i.isCatLoading&&i.isSubPostLoading?2:3))},dependencies:[L,E,T,F,N]})};export{R as SingleCategorieComponent};
